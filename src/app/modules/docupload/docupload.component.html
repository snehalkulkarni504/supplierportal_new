<div class="setheight">

    <div class="MasterHeader">
        <div style="width: 50%">
            <div class="searchbox" style="border: #0066b2;">
                <!-- <input type="text" [(ngModel)]="searchQuery" class="form-control" placeholder="Search..."
                    (input)="onSearch()" /> -->
            </div>
        </div>

        <div class="text-end" style="width: 50%;">
            <br>

            <button type="button" class="btn-close" aria-label="Close"
                onmouseover="this.style.transform='scale(1.1)'; this.style.transition='transform 0.2s ease-in-out'"
                onmouseout="this.style.transform='scale(1)'; this.style.transition='transform 0.2s ease-in-out'"
                (click)="onClose()"></button>

        </div>
    </div>


    <div class="table-container">
        <table class="table table-bordered table-striped " style="font-size: 13px !important;">
            <thead>
                <tr>
                    <th>Sr No.</th>
                    <th>Document Type</th>
                    <th>Lot Number</th>
                    <th>Upload Date</th>
                    <th>Supplier Remarks</th>
                    <th>Status</th>
                    <th>TPSL Remarks</th>
                    <th>Action</th>
                    
                </tr>
            </thead>

            <tbody style="vertical-align:middle;">
                <tr *ngFor="let d of filteredData,let i=index">
                     <td>{{i+1}}</td>
                    <td>{{d.documentType}}</td>
                    <td>{{d.lotNumber}}</td>
                    <td>{{d.uploadDate}}</td>
                    <td>{{d.tpslremarks}}</td>
                    <td class="status-cell"[ngClass]="{'pending-row': d.isApproved === 0,'approved-row': d.isApproved === 1,'rejected-row': d.isApproved === 2}">
                    {{ d.isApproved === 0 ? 'WIP' : d.isApproved === 1 ? 'Approved' : 'Rejected' }}
                    </td>
                    <td>{{d.tpslremarks}}</td>
                    <td>
                        <div style="display: contents; font-size: 18px;">
                            <img src="../../../assets/download.png" style="width: 31px;margin-right: 8px; cursor: pointer;" title="download" alt="" (click)="onDownload(d)">
                            <img *ngIf="roleid==5"src="../../../assets/upload.png" style="width: 31px; margin-right: 8px; cursor: pointer;" title="Upload" alt="" (click)="fileInput.click()">
                            <input type="file" #fileInput (change)="onFileSelected($event,d)" hidden />
                            <img *ngIf="roleid==3 && !d.isApproved" src="../../../assets/approve-48.png" style="width: 27px; margin-right: 5px; cursor: pointer;" title="Approve" alt="" (click)="approve(d)">
                            <img *ngIf="roleid==3 && !d.isApproved" src="../../../assets/cancel.png" style="width: 29px; margin-right: 3px; cursor: pointer;" title="Reject" alt="" (click)="rejectmodal(d)">                    
                        </div>
                    </td>
            </tbody>
        </table>
    </div>

    <nav aria-label="Page navigation example">
        <ul class="pagination">
            <ngb-pagination [collectionSize]="filteredData.length" [(page)]="currentPage" [pageSize]="itemsPerPage"
                (pageChange)="onPageChange($event)" aria-label="Default pagination"></ngb-pagination>
        </ul>
    </nav>


    <div *ngIf="hideuploadsec" class="upload-section">

        <div class="upload-container d-flex">
            <div class="file-input-container">

                <div class="file-input">
                    <h3>Upload Document</h3>
                    <p class="upload-instructions">Attach a file, then provide details.</p>
                    <label for="fileUpload" class="file-label">
                        <i class="fa fa-upload"></i> Choose a File
                    </label>
                    <input type="file" id="fileUpload" class="file-hidden" [disabled]="disable"
                        (change)="onFileChange($event)">
                    <p *ngIf="selectedFile" class="file-name">Selected: {{ selectedFile.name }}</p>
                </div>
            </div>
            <div class="input-fields-container">
                <div class="input-group">

                    <label for="documenttype" style="margin-top: 8px; padding-right: 4px;">Document
                        Type:<span style="color: red;">*</span></label>
                   
                    <select style="width: 10%; border-radius: 7px;" id="documentType" [(ngModel)]="documenttype"
                        class="form-control" [class.is-invalid]="!documenttype && showValidationError" required>
                        <option value="" disabled selected>Select Document Type</option>
                        <option *ngFor="let type of documentTypes" [value]="type">{{ type }}</option>
                    </select>
                </div>

                <div class="input-group" style="margin-top: 6px;">
                    <label for="remarks" style="padding-top: 10px;">Remarks:</label>
                    <textarea id="remarks" style="border-radius: 7px;width: 50%;height: 45px;" [(ngModel)]="remarks"
                        class="form-control" placeholder="Add any remarks here..."></textarea>
                </div>
            </div>
        </div>


        <div class="button-group">
            <button [disabled]="disable" class="btn btn-primary" (click)="onUpload()">Upload</button>
        </div>
    </div>

    <!-- rejection-modal.component.html -->
<div class="modal-overlay" *ngIf="isModalOpen">
    <div class="modal-content">
      <h2>Reject Request</h2>
      
      <label for="remarks">Rejection Remarks</label>
      <textarea id="remarks" [(ngModel)]="rejectionRemarks" rows="4" placeholder="Enter reason for rejection..."></textarea>
  
      <div class="modal-actions">
        <button class="close-btn" (click)="closeModal()">Close</button>
        <button class="reject-btn" (click)="submitRejection()">Reject</button>
      </div>
    </div>
  </div>
  

</div>