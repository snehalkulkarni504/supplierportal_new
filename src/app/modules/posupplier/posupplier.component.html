<div class="AllpagesContent" style="width:90%;margin-left: 5%;">
  <form [formGroup]="POSupplierScreen">
    <!-- <p>posupplier works!</p> -->
    <div class="MasterHeaderrr">
      <div class="text-center" style="width: 10%; float: left; line-height: 60px; margin-left: -75px;">
        <i class="fas fa-arrow-circle-left back_button"
          style="color: #00509e; cursor: pointer; position: absolute; left: 61px; top: 65px; font-size: 24px;"
          title="Back" (click)="goBack()" aria-label="Go back to the previous page"
          onmouseover="this.style.transform='scale(1.1)'; this.style.transition='transform 0.2s ease-in-out'"
          onmouseout="this.style.transform='scale(1)'; this.style.transition='transform 0.2s ease-in-out'" tabindex="0">
        </i>
      </div>

      <!-- <div class="text-start" style="width: auto; float: left;">
      <h2 style="font-weight: bold; color: #278bd8; line-height: 60px; font-size: 28px; margin-left: 70px; white-space: nowrap;">
          PO Details
      </h2>
    </div> -->

      <h4 class="font-weight-bold" style="text-align: center;font-weight: bold; color: #278bd8; font-size: 28px;">{{
        SupplierName }}</h4>

    </div>
    <div class="m-0 p-0">
      <h2 class="po-details-heading">
        My POs
      </h2>
    </div>

    <!-- <div class="col-12" class="left-content">
        <h4>PO Details</h4>
      </div> -->
    <!-- <div class="col-12" class="centered-content">
    <p style="margin-bottom: 0.5rem">{{SupplierName}}</p>
  </div>
  <div class="col-12" class="left-content">
    <h4>PO Details</h4>
  </div> -->
    <hr style="border-color: #4d94c9; margin:0px;">
    <!-- <div class="row" class="line-content">
    <hr style="margin-top: 0.5rem;color: #00509e;" class="line-content">
  </div> -->
    <div class="container-fluid py-2" style="margin-left: -13px;">
      <div class="row align-items-center g-2">

        <!-- Dropdown for PO Numbers -->
        <div class="col-md-auto col-sm-12 d-flex flex-column align-items-start me-3">
          <label class="form-label mb-1">PO No:</label>
          <ng-select class="ng-selectcustomer" [multiple]="true" [items]="PONumbers" bindLabel="poNumber"
            [(ngModel)]="selectedPOs" (change)="togglePoSelection()" placeholder="---Select PO---" style="width: 224px;"
            [ngModelOptions]="{standalone: true}">

          </ng-select>
        </div>

        <!-- From PO Date -->
        <div class="col-md-auto col-sm-6 d-flex flex-column align-items-start me-3">
          <label class="form-label mb-0">From PO Date:</label>
          <input type="date" class="form-control date-picker" [(ngModel)]="FromPODate"
            [ngModelOptions]="{standalone: true}" (change)="filterTableData()" />
        </div>

        <!-- To PO Date -->
        <div class="col-md-auto col-sm-6 d-flex flex-column align-items-start me-3">
          <label class="form-label mb-0">To PO Date:</label>
          <input type="date" class="form-control date-picker" [(ngModel)]="ToPODate"
            [ngModelOptions]="{standalone: true}" (change)="filterTableData()" />
        </div>

        <!-- Status Dropdown (Converted to ng-select) -->
        <div class="col-md-auto col-sm-12 d-flex flex-column align-items-start me-3">
          <label class="form-label mb-1">Status:</label>
          <ng-select class="ng-selectcustomer" [multiple]="true" [items]="Status" bindLabel="status" bindValue="status"
            [(ngModel)]="selectedstatus" (change)="toggleStatusSelection(selectedstatus)"
            placeholder="---Select Status---" style="width: 224px;" [ngModelOptions]="{standalone: true}">
          </ng-select>
        </div>

        <!-- View Icon -->
        <div class="col-md-auto col-sm-12 d-flex align-items-center" style="margin-top: 35px;">
          <img src="../../../assets/filter.png" (click)="filterTableData()" title="filter" class="filter-icon" alt="">
          <i class="fas fa-sync me-3 text-danger clickable-icon" title="Reset" (click)="ClearControls()"></i>
        </div>
      </div>
    </div>

    <!-- <div class="searchDiv">
      <div class="form-group has-search searchbox2">
        <span class="bi bi-search form-control-feedback"></span>
        <input type="text" class="form-control search-input" placeholder="Search" formControlName="textsearch"
          [(ngModel)]="textsearch">
      </div>
    </div> -->
 <div class="action-row">
  <div class="searchDiv">
    <div class="form-group has-search searchbox2">
      <span class="bi bi-search form-control-feedback"></span>
      <input type="text" class="form-control search-input" placeholder="Search"
             formControlName="textsearch" [(ngModel)]="textsearch">
    </div>
  </div>
  <div class="button-group">
    <button class="download-btn" (click)="Downloadtemplate()">Download Template</button>
    <button class="download-btn" (click)="openUploadModal()">Upload Excel</button>
  </div>
</div>
    <div class="justify-content-center">
      <div class="table-responsive">
        <table class="table table-bordered table-striped"
          style="font-size: 13px !important; min-width: 330px !important; overflow-x: auto;">
          <thead>
            <tr>
              <!-- <th>Timesheet No</th> -->

              <th (click)="poPopupDisplay = 'block'">PO No</th>
              <th (click)="dateDisplay = 'block'">PO Date</th>
              <th>Doc. Type</th>
              <th>Status</th>
              <!-- <th>Supplier Remark</th> -->
              <!-- <th>TPS Remark</th>-->
              <th>Delivery Schedule</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let value of filteredTableData | search: textsearch:filterMetadata | paginate: { itemsPerPage: 10, currentPage: page } let i=index">
              <!-- <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td> -->
              <td>{{value.poNumber}}</td>
              <!--<td>{{value.TimeSheet_No}}</td>-->
              <td>{{value.poDate}}</td>
              <td>{{value.docType}}</td>
              <td>{{value.status}}</td>
              <!-- <td>{{value.supplierremark}}</td>
                    <td>{{value.tpsremark}}</td> -->
              <td><i (click)="openDeliverySchedule(value.poNumber,value.status,SupplierName)" class="clickable"
                  [ngClass]="value.status === 'Open' || value.status === 'WIP' ?'fas fa-edit': 'fas fa-file-alt'"
                  style="cursor: pointer; font-size: 1.2rem;" [ngStyle]="{
                        color: value.status === 'Open' ? '#ffc107' : 
                               value.status === 'WIP' ? '#ffc107' : 
                               '#6c757d'}"></i></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- <div class="text-center mt-3">
        <p>Page {{ currentPage }} of {{ totalPages }}</p>
      </div> -->
    </div>
    <div class="d-flex justify-content-between pagination">
      <ngb-pagination [collectionSize]="filterMetadata.count" [(page)]="page" [pageSize]="pageSize" [rotate]="true"
        [boundaryLinks]="true" [maxSize]="5" size="sm" (pageChange)="onPageChange($event)">
        <!-- <ng-template ngbPaginationPrevious>Prev</ng-template>
        <ng-template ngbPaginationNext>Next</ng-template> -->
      </ngb-pagination>
      <br>
    </div>
  </form>
</div>


 <div class="modal " tabindex="-1" role="dialog" [ngStyle]="{'display':display}">
     <div class="modal-dialog  modal-dialog-centered" role="document">
         <div class="modal-content">

<div class="modal-header">
    <h4 class="modal-title">Upload Excel</h4>
    <label class="close modal-close-icn" (click)="onCloseHandled()">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#000" class="bi bi-x"
            viewBox="0 0 16 16">
            <path
                d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
        </svg>
    </label>
</div>
<div class="modal-content" >
    
    <div class="modal-body">

        
        
        <div style="display: flex; align-items: center; gap: 12px;">
            <label for="fileInput"
                   style="padding: 6px 12px; background-color: #4e54c8; color: white; border-radius: 4px; cursor: pointer; font-size: 14px;">
              Choose File
            </label>
         
            <input type="file" id="fileInput" (change)="onFileSelected($event)" accept=".xlsx"
                   style="display: none;">
           
            <span style="font-size: 14px; color: #333;" *ngIf="selectedfilename">{{ selectedfilename }}</span>
          </div>                    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-secondary" (click)="onCloseHandled()">Close</button>
        <button type="button" class="btn btn-sm  btn-default default-btn_popup"
            (click)="uploadExcel()">Upload</button>
    </div>
</div>
</div>
</div>
</div>

<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{ 'display': dateDisplay }">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">

      <!-- Header -->
      <div class="modal-header">
        <h4 class="modal-title">Select Date Range</h4>
        <label class="close modal-close-icn" (click)="onCloseHandled()">
          <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#000" class="bi bi-x"
            viewBox="0 0 16 16">
            <path
              d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
          </svg>
        </label>
      </div>

      <!-- Body -->
      <div class="modal-body">
        <form>
          <div class="form-group mb-3">
            <label for="fromDate">From Date:</label>
            <input type="date" class="form-control" id="fromDate" [(ngModel)]="fromDate" name="fromDate" />
          </div>
          <div class="form-group mb-3">
            <label for="toDate">To Date:</label>
            <input type="date" class="form-control" id="toDate" [(ngModel)]="toDate" name="toDate" />
          </div>
        </form>
      </div>

      <!-- Footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-secondary" (click)="onCloseHandled()">Close</button>
        <button type="button" class="btn btn-sm btn-primary" (click)="submitDate()">Submit</button>
      </div>

    </div>
  </div>
</div>

<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{ 'display': poPopupDisplay }">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">

      <!-- Header -->
      <div class="modal-header">
        <h4 class="modal-title">Select PO Number Range</h4>
        <label class="close modal-close-icn" (click)="closePOPopup()">
          <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#000" class="bi bi-x" viewBox="0 0 16 16">
            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
          </svg>
        </label>
      </div>

      <!-- Body -->
      <div class="modal-body">
        <form>
          <div class="form-group mb-3">
            <label for="fromPO">From PO No:</label>
            <select class="form-control" id="fromPO" [(ngModel)]="selectedFromPO" name="fromPO">
              <option [ngValue]="null" selected hidden>Select PO</option>
              <option *ngFor="let po of PONumbers" [value]="po.poNumber" >{{ po.poNumber }}</option>
            </select>
          </div>
          <div class="form-group mb-3">
            <label for="toPO">To PO No:</label>
            <select class="form-control" id="toPO" [(ngModel)]="selectedToPO" name="toPO">
              <option [ngValue]="null" selected hidden>Select PO</option>
              <option *ngFor="let po of PONumbers" [value]="po.poNumber" >{{ po.poNumber }}</option>
            </select>
          </div>
        </form>
      </div>

      <!-- Footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-secondary" (click)="closePOPopup()">Close</button>
        <button type="button" class="btn btn-sm btn-primary" (click)="applyPOFilter()">Apply Filter</button>
      </div>

    </div>
  </div>
</div>

<!-- <app-poschedule [PONumber]="prog_title" 
    [postatus]="curr_info" [suppliername]="curr_info">
</app-poschedule> -->